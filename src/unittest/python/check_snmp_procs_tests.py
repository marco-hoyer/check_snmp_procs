from mockito import mock, verify
import unittest

import check_snmp_procs

class check_snmp_procs_test (unittest.TestCase):

	def test_execute(self):
		self.assertEqual(check_snmp_procs.execute("which",['python']), (0, '/usr/bin/python\n', ''))
		self.assertEqual(check_snmp_procs.execute("echo",['Hallo Welt']), (0, 'Hallo Welt\n', ''))
		self.assertEqual(check_snmp_procs.execute("echo",['Hallo','Welt','test','1','2','3']), (0, 'Hallo Welt test 1 2 3\n', ''))
		self.assertEqual(check_snmp_procs.execute("echo",[]), (0, '\n', ''))

	def test_create_list_from_csv(self):
		self.assertEqual(check_snmp_procs.create_list_from_csv("httpd"),['httpd'])
		self.assertEqual(check_snmp_procs.create_list_from_csv("httpd,crond,sshd,ntpd"),['httpd','crond','sshd','ntpd'])
		self.assertEqual(check_snmp_procs.create_list_from_csv("a"),['a'])
		self.assertEqual(check_snmp_procs.create_list_from_csv(""),[''])
		self.assertEqual(check_snmp_procs.create_list_from_csv("qmgr -l -t fifo -u,/sbin/dhclient -H devmho01 -q -cf /etc/dhcp/dhclient-eth0.conf -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0"),['qmgr -l -t fifo -u','/sbin/dhclient -H devmho01 -q -cf /etc/dhcp/dhclient-eth0.conf -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0'])
		self.assertEqual(check_snmp_procs.create_list_from_csv("[ext4-dio-unwrit]"),['[ext4-dio-unwrit]'])
		
	def test_check_running(self):
		processes = {'4167': 'vmtoolsd', '1141': 'nslcd', '2349': 'httpd -DRunAsApache','4235': 'ntpd -u ntp:ntp -p /var/run/ntpd.pid -g -x','16321': 'snmpd -LS0-6d -Lf /dev/null -p /var/run/snmpd.pid','3951': 'automount --pid-file /var/run/autofs.pid','3877': 'acpid','7637': 'qmgr -l -t fifo -u'}
		self.assertTrue(check_snmp_procs.check_running(processes,"vmtoolsd"))
		self.assertTrue(check_snmp_procs.check_running(processes," vmtoolsd "))
		self.assertTrue(check_snmp_procs.check_running(processes,"ntpd -u ntp:ntp -p /var/run/ntpd.pid -g -x"))
		self.assertTrue(check_snmp_procs.check_running(processes,"ntpd -u ntp:ntp"))
		self.assertTrue(check_snmp_procs.check_running(processes,"ntpd"))
		self.assertFalse(check_snmp_procs.check_running(processes,"ntp -u ntp:ntp"))
		self.assertFalse(check_snmp_procs.check_running(processes,"  "))

	def test_convert_list_to_kv_dict(self):
		in1 = ['hrSWRunName.1 = "init"', 'hrSWRunName.2 = "kthreadd"', 'hrSWRunName.3 = "migration/0"', 'hrSWRunName.4 = "ksoftirqd/0"', 'hrSWRunName.5 = "migration/0"', 'hrSWRunName.6 = "watchdog/0"', 'hrSWRunName.7 = "migration/1"', 'hrSWRunName.8 = "migration/1"', 'hrSWRunName.9 = "ksoftirqd/1"', 'hrSWRunName.10 = "watchdog/1"', 'hrSWRunName.11 = "migration/2"', 'hrSWRunName.12 = "migration/2"', 'hrSWRunName.13 = "ksoftirqd/2"', 'hrSWRunName.14 = "watchdog/2"', 'hrSWRunName.15 = "migration/3"', 'hrSWRunName.16 = "migration/3"', 'hrSWRunName.17 = "ksoftirqd/3"', 'hrSWRunName.18 = "watchdog/3"', 'hrSWRunName.19 = "events/0"', 'hrSWRunName.20 = "events/1"', 'hrSWRunName.21 = "events/2"', 'hrSWRunName.22 = "events/3"', 'hrSWRunName.23 = "cgroup"', 'hrSWRunName.24 = "khelper"', 'hrSWRunName.25 = "netns"', 'hrSWRunName.26 = "async/mgr"', 'hrSWRunName.27 = "pm"', 'hrSWRunName.28 = "sync_supers"', 'hrSWRunName.29 = "bdi-default"', 'hrSWRunName.30 = "kintegrityd/0"', 'hrSWRunName.31 = "kintegrityd/1"', 'hrSWRunName.32 = "kintegrityd/2"', 'hrSWRunName.33 = "kintegrityd/3"', 'hrSWRunName.34 = "kblockd/0"', 'hrSWRunName.35 = "kblockd/1"', 'hrSWRunName.36 = "kblockd/2"', 'hrSWRunName.37 = "kblockd/3"', 'hrSWRunName.38 = "kacpid"', 'hrSWRunName.39 = "kacpi_notify"', 'hrSWRunName.40 = "kacpi_hotplug"', 'hrSWRunName.41 = "ata/0"', 'hrSWRunName.42 = "ata/1"', 'hrSWRunName.43 = "ata/2"', 'hrSWRunName.44 = "ata/3"', 'hrSWRunName.45 = "ata_aux"', 'hrSWRunName.46 = "ksuspend_usbd"', 'hrSWRunName.47 = "khubd"', 'hrSWRunName.48 = "kseriod"', 'hrSWRunName.49 = "md/0"', 'hrSWRunName.50 = "md/1"', 'hrSWRunName.51 = "md/2"', 'hrSWRunName.52 = "md/3"', 'hrSWRunName.53 = "md_misc/0"', 'hrSWRunName.54 = "md_misc/1"', 'hrSWRunName.55 = "md_misc/2"', 'hrSWRunName.56 = "md_misc/3"', 'hrSWRunName.57 = "khungtaskd"', 'hrSWRunName.58 = "kswapd0"', 'hrSWRunName.59 = "ksmd"', 'hrSWRunName.60 = "khugepaged"', 'hrSWRunName.61 = "aio/0"', 'hrSWRunName.62 = "aio/1"', 'hrSWRunName.63 = "aio/2"', 'hrSWRunName.64 = "aio/3"', 'hrSWRunName.65 = "crypto/0"', 'hrSWRunName.66 = "crypto/1"', 'hrSWRunName.67 = "crypto/2"', 'hrSWRunName.68 = "crypto/3"', 'hrSWRunName.73 = "kthrotld/0"', 'hrSWRunName.74 = "kthrotld/1"', 'hrSWRunName.75 = "kthrotld/2"', 'hrSWRunName.76 = "kthrotld/3"', 'hrSWRunName.77 = "pciehpd"', 'hrSWRunName.79 = "kpsmoused"', 'hrSWRunName.80 = "usbhid_resumer"', 'hrSWRunName.110 = "kstriped"', 'hrSWRunName.317 = "scsi_eh_0"', 'hrSWRunName.318 = "scsi_eh_1"', 'hrSWRunName.338 = "scsi_eh_2"', 'hrSWRunName.339 = "vmw_pvscsi_wq_2"', 'hrSWRunName.364 = "jbd2/sda1-8"', 'hrSWRunName.365 = "ext4-dio-unwrit"', 'hrSWRunName.366 = "ext4-dio-unwrit"', 'hrSWRunName.367 = "ext4-dio-unwrit"', 'hrSWRunName.368 = "ext4-dio-unwrit"', 'hrSWRunName.377 = "flush-8:0"', 'hrSWRunName.407 = "kauditd"', 'hrSWRunName.455 = "udevd"', 'hrSWRunName.652 = "vmmemctl"', 'hrSWRunName.803 = "udevd"', 'hrSWRunName.827 = "jbd2/sda3-8"', 'hrSWRunName.828 = "ext4-dio-unwrit"', 'hrSWRunName.829 = "ext4-dio-unwrit"', 'hrSWRunName.830 = "ext4-dio-unwrit"', 'hrSWRunName.831 = "ext4-dio-unwrit"', 'hrSWRunName.832 = "jbd2/sda2-8"', 'hrSWRunName.833 = "ext4-dio-unwrit"', 'hrSWRunName.834 = "ext4-dio-unwrit"', 'hrSWRunName.835 = "ext4-dio-unwrit"', 'hrSWRunName.836 = "ext4-dio-unwrit"', 'hrSWRunName.1086 = "dhclient"', 'hrSWRunName.1134 = "portreserve"', 'hrSWRunName.1141 = "nslcd"', 'hrSWRunName.1154 = "rsyslogd"', 'hrSWRunName.1183 = "irqbalance"', 'hrSWRunName.1197 = "rpcbind"', 'hrSWRunName.1215 = "rpc.statd"', 'hrSWRunName.1243 = "rpciod/0"', 'hrSWRunName.1244 = "rpciod/1"', 'hrSWRunName.1245 = "rpciod/2"', 'hrSWRunName.1246 = "rpciod/3"', 'hrSWRunName.1250 = "rpc.idmapd"', 'hrSWRunName.2330 = "httpd"', 'hrSWRunName.2331 = "httpd"', 'hrSWRunName.2332 = "httpd"', 'hrSWRunName.2333 = "httpd"', 'hrSWRunName.2334 = "httpd"', 'hrSWRunName.2336 = "httpd"', 'hrSWRunName.2337 = "httpd"', 'hrSWRunName.2340 = "httpd"', 'hrSWRunName.2342 = "httpd"', 'hrSWRunName.2343 = "httpd"', 'hrSWRunName.2344 = "httpd"', 'hrSWRunName.2345 = "httpd"', 'hrSWRunName.2346 = "httpd"', 'hrSWRunName.2347 = "httpd"', 'hrSWRunName.2348 = "httpd"', 'hrSWRunName.2349 = "httpd"', 'hrSWRunName.2350 = "httpd"', 'hrSWRunName.2351 = "httpd"', 'hrSWRunName.2352 = "httpd"', 'hrSWRunName.2353 = "httpd"', 'hrSWRunName.2354 = "httpd"', 'hrSWRunName.2355 = "httpd"', 'hrSWRunName.2356 = "httpd"', 'hrSWRunName.2357 = "httpd"', 'hrSWRunName.2358 = "httpd"', 'hrSWRunName.2359 = "httpd"', 'hrSWRunName.2360 = "httpd"', 'hrSWRunName.2361 = "httpd"', 'hrSWRunName.2362 = "httpd"', 'hrSWRunName.2363 = "httpd"', 'hrSWRunName.2364 = "httpd"', 'hrSWRunName.2365 = "httpd"', 'hrSWRunName.2366 = "httpd"', 'hrSWRunName.2367 = "httpd"', 'hrSWRunName.2368 = "httpd"', 'hrSWRunName.2369 = "httpd"', 'hrSWRunName.2370 = "httpd"', 'hrSWRunName.2371 = "httpd"', 'hrSWRunName.2372 = "httpd"', 'hrSWRunName.2375 = "httpd"', 'hrSWRunName.2376 = "httpd"', 'hrSWRunName.2377 = "httpd"', 'hrSWRunName.2378 = "httpd"', 'hrSWRunName.2379 = "httpd"', 'hrSWRunName.2380 = "httpd"', 'hrSWRunName.2386 = "httpd"', 'hrSWRunName.2387 = "httpd"', 'hrSWRunName.2388 = "httpd"', 'hrSWRunName.2389 = "httpd"', 'hrSWRunName.2390 = "httpd"', 'hrSWRunName.2391 = "httpd"', 'hrSWRunName.2392 = "httpd"', 'hrSWRunName.2393 = "httpd"', 'hrSWRunName.2394 = "httpd"', 'hrSWRunName.2395 = "httpd"', 'hrSWRunName.2396 = "httpd"', 'hrSWRunName.2397 = "httpd"', 'hrSWRunName.2398 = "httpd"', 'hrSWRunName.2399 = "httpd"', 'hrSWRunName.2400 = "httpd"', 'hrSWRunName.2401 = "httpd"', 'hrSWRunName.2407 = "python"', 'hrSWRunName.3838 = "dbus-daemon"', 'hrSWRunName.3877 = "acpid"', 'hrSWRunName.3886 = "hald"', 'hrSWRunName.3887 = "hald-runner"', 'hrSWRunName.3916 = "hald-addon-inpu"', 'hrSWRunName.3937 = "hald-addon-acpi"', 'hrSWRunName.3951 = "automount"', 'hrSWRunName.4167 = "vmtoolsd"', 'hrSWRunName.4235 = "ntpd"', 'hrSWRunName.4243 = "nrpe"', 'hrSWRunName.4335 = "python"', 'hrSWRunName.4342 = "crond"', 'hrSWRunName.4353 = "atd"', 'hrSWRunName.4404 = "mingetty"', 'hrSWRunName.4406 = "mingetty"', 'hrSWRunName.4408 = "mingetty"', 'hrSWRunName.4410 = "mingetty"', 'hrSWRunName.4412 = "mingetty"', 'hrSWRunName.4414 = "mingetty"', 'hrSWRunName.4415 = "udevd"', 'hrSWRunName.7180 = "sshd"', 'hrSWRunName.7182 = "sshd"', 'hrSWRunName.7630 = "master"', 'hrSWRunName.7636 = "pickup"', 'hrSWRunName.7637 = "qmgr"', 'hrSWRunName.7639 = "smtp"', 'hrSWRunName.7640 = "smtp"', 'hrSWRunName.7641 = "bounce"', 'hrSWRunName.7649 = "smtp"', 'hrSWRunName.7652 = "bounce"', 'hrSWRunName.7654 = "error"', 'hrSWRunName.7661 = "error"', 'hrSWRunName.7670 = "error"', 'hrSWRunName.7700 = "sshd"', 'hrSWRunName.16321 = "snmpd"', 'hrSWRunName.20458 = "diamond"', 'hrSWRunName.20509 = "httpd"', 'hrSWRunName.20617 = "ido2db"', 'hrSWRunName.20619 = "icinga"', 'hrSWRunName.20666 = "nscd"', 'hrSWRunName.27133 = "ido2db"', '']

		out1 = {'4167': 'vmtoolsd', '1141': 'nslcd', '2349': 'httpd', '7652': 'bounce', '2348': 'httpd', '7637': 'qmgr', '1197': 'rpcbind', '24': 'khelper', '25': 'netns', '26': 'async/mgr', '27': 'pm', '20': 'events/1', '21': 'events/2', '22': 'events/3', '23': 'cgroup', '28': 'sync_supers', '29': 'bdi-default', '407': 'kauditd', '2407': 'python', '4': 'ksoftirqd/0', '2400': 'httpd', '2401': 'httpd', '8': 'migration/1', '2398': 'httpd', '368': 'ext4-dio-unwrit', '20458': 'diamond', '1154': 'rsyslogd', '3937': 'hald-addon-acpi', '4335': 'python', '3838': 'dbus-daemon', '3887': 'hald-runner', '2389': 'httpd', '3886': 'hald', '2388': 'httpd', '4408': 'mingetty', '4235': 'ntpd', '2392': 'httpd', '59': 'ksmd', '58': 'kswapd0', '55': 'md_misc/2', '54': 'md_misc/1', '57': 'khungtaskd', '56': 'md_misc/3', '51': 'md/2', '50': 'md/1', '53': 'md_misc/0', '52': 'md/3', '2396': 'httpd', '2397': 'httpd', '2394': 'httpd', '2395': 'httpd', '829': 'ext4-dio-unwrit', '828': 'ext4-dio-unwrit', '2390': 'httpd', '2391': 'httpd', '7654': 'error', '827': 'jbd2/sda3-8', '4406': 'mingetty', '377': 'flush-8:0', '2399': 'httpd', '1086': 'dhclient', '318': 'scsi_eh_1', '20617': 'ido2db', '20619': 'icinga', '317': 'scsi_eh_0', '20509': 'httpd', '110': 'kstriped', '4404': 'mingetty', '80': 'usbhid_resumer', '832': 'jbd2/sda2-8', '833': 'ext4-dio-unwrit', '830': 'ext4-dio-unwrit', '831': 'ext4-dio-unwrit', '836': 'ext4-dio-unwrit', '834': 'ext4-dio-unwrit', '835': 'ext4-dio-unwrit', '4415': 'udevd', '4414': 'mingetty', '7636': 'pickup', '4412': 'mingetty', '4410': 'mingetty', '2380': 'httpd', '3': 'migration/0', '7': 'migration/1', '2386': 'httpd', '366': 'ext4-dio-unwrit', '367': 'ext4-dio-unwrit', '364': 'jbd2/sda1-8', '365': 'ext4-dio-unwrit', '2393': 'httpd', '16321': 'snmpd', '3951': 'automount', '1134': 'portreserve', '27133': 'ido2db', '2387': 'httpd', '39': 'kacpi_notify', '38': 'kacpid', '7639': 'smtp', '7700': 'sshd', '33': 'kintegrityd/3', '32': 'kintegrityd/2', '31': 'kintegrityd/1', '30': 'kintegrityd/0', '37': 'kblockd/3', '36': 'kblockd/2', '35': 'kblockd/1', '34': 'kblockd/0', '1243': 'rpciod/0', '1245': 'rpciod/2', '1244': 'rpciod/1', '1246': 'rpciod/3', '2375': 'httpd', '2376': 'httpd', '2377': 'httpd', '2370': 'httpd', '2371': 'httpd', '2372': 'httpd', '339': 'vmw_pvscsi_wq_2', '338': 'scsi_eh_2', '455': 'udevd', '1250': 'rpc.idmapd', '60': 'khugepaged', '61': 'aio/0', '62': 'aio/1', '63': 'aio/2', '64': 'aio/3', '65': 'crypto/0', '66': 'crypto/1', '67': 'crypto/2', '68': 'crypto/3', '4342': 'crond', '7180': 'sshd', '2': 'kthreadd', '652': 'vmmemctl', '2369': 'httpd', '6': 'watchdog/0', '2367': 'httpd', '2366': 'httpd', '2365': 'httpd', '2364': 'httpd', '2363': 'httpd', '2362': 'httpd', '2361': 'httpd', '2360': 'httpd', '1215': 'rpc.statd', '2368': 'httpd', '3877': 'acpid', '7641': 'bounce', '7640': 'smtp', '7649': 'smtp', '11': 'migration/2', '10': 'watchdog/1', '13': 'ksoftirqd/2', '12': 'migration/2', '15': 'migration/3', '14': 'watchdog/2', '17': 'ksoftirqd/3', '16': 'migration/3', '19': 'events/0', '18': 'watchdog/3', '1183': 'irqbalance', '4353': 'atd', '2358': 'httpd', '2359': 'httpd', '2352': 'httpd', '2353': 'httpd', '2350': 'httpd', '2351': 'httpd', '2356': 'httpd', '2357': 'httpd', '2354': 'httpd', '2355': 'httpd', '4243': 'nrpe', '7670': 'error', '2345': 'httpd', '2344': 'httpd', '2347': 'httpd', '2346': 'httpd', '2340': 'httpd', '48': 'kseriod', '49': 'md/0', '46': 'ksuspend_usbd', '47': 'khubd', '44': 'ata/3', '45': 'ata_aux', '42': 'ata/1', '43': 'ata/2', '40': 'kacpi_hotplug', '41': 'ata/0', '1': 'init', '5': 'migration/0', '9': 'ksoftirqd/1', '2378': 'httpd', '2379': 'httpd', '3916': 'hald-addon-inpu', '77': 'pciehpd', '76': 'kthrotld/3', '75': 'kthrotld/2', '74': 'kthrotld/1', '73': 'kthrotld/0', '7661': 'error', '20666': 'nscd', '79': 'kpsmoused', '2330': 'httpd', '2331': 'httpd', '2332': 'httpd', '2333': 'httpd', '2334': 'httpd', '2343': 'httpd', '2336': 'httpd', '2337': 'httpd', '2342': 'httpd', '803': 'udevd', '7182': 'sshd', '7630': 'master'}

		in2 = ['hrSWRunParameters.1 = ""', 'hrSWRunParameters.2 = ""', 'hrSWRunParameters.3 = ""', 'hrSWRunParameters.4 = ""', 'hrSWRunParameters.5 = ""', 'hrSWRunParameters.6 = ""', 'hrSWRunParameters.7 = ""', 'hrSWRunParameters.8 = ""', 'hrSWRunParameters.9 = ""', 'hrSWRunParameters.10 = ""', 'hrSWRunParameters.11 = ""', 'hrSWRunParameters.12 = ""', 'hrSWRunParameters.13 = ""', 'hrSWRunParameters.14 = ""', 'hrSWRunParameters.15 = ""', 'hrSWRunParameters.16 = ""', 'hrSWRunParameters.17 = ""', 'hrSWRunParameters.18 = ""', 'hrSWRunParameters.19 = ""', 'hrSWRunParameters.20 = ""', 'hrSWRunParameters.21 = ""', 'hrSWRunParameters.22 = ""', 'hrSWRunParameters.23 = ""', 'hrSWRunParameters.24 = ""', 'hrSWRunParameters.25 = ""', 'hrSWRunParameters.26 = ""', 'hrSWRunParameters.27 = ""', 'hrSWRunParameters.28 = ""', 'hrSWRunParameters.29 = ""', 'hrSWRunParameters.30 = ""', 'hrSWRunParameters.31 = ""', 'hrSWRunParameters.32 = ""', 'hrSWRunParameters.33 = ""', 'hrSWRunParameters.34 = ""', 'hrSWRunParameters.35 = ""', 'hrSWRunParameters.36 = ""', 'hrSWRunParameters.37 = ""', 'hrSWRunParameters.38 = ""', 'hrSWRunParameters.39 = ""', 'hrSWRunParameters.40 = ""', 'hrSWRunParameters.41 = ""', 'hrSWRunParameters.42 = ""', 'hrSWRunParameters.43 = ""', 'hrSWRunParameters.44 = ""', 'hrSWRunParameters.45 = ""', 'hrSWRunParameters.46 = ""', 'hrSWRunParameters.47 = ""', 'hrSWRunParameters.48 = ""', 'hrSWRunParameters.49 = ""', 'hrSWRunParameters.50 = ""', 'hrSWRunParameters.51 = ""', 'hrSWRunParameters.52 = ""', 'hrSWRunParameters.53 = ""', 'hrSWRunParameters.54 = ""', 'hrSWRunParameters.55 = ""', 'hrSWRunParameters.56 = ""', 'hrSWRunParameters.57 = ""', 'hrSWRunParameters.58 = ""', 'hrSWRunParameters.59 = ""', 'hrSWRunParameters.60 = ""', 'hrSWRunParameters.61 = ""', 'hrSWRunParameters.62 = ""', 'hrSWRunParameters.63 = ""', 'hrSWRunParameters.64 = ""', 'hrSWRunParameters.65 = ""', 'hrSWRunParameters.66 = ""', 'hrSWRunParameters.67 = ""', 'hrSWRunParameters.68 = ""', 'hrSWRunParameters.73 = ""', 'hrSWRunParameters.74 = ""', 'hrSWRunParameters.75 = ""', 'hrSWRunParameters.76 = ""', 'hrSWRunParameters.77 = ""', 'hrSWRunParameters.79 = ""', 'hrSWRunParameters.80 = ""', 'hrSWRunParameters.110 = ""', 'hrSWRunParameters.317 = ""', 'hrSWRunParameters.318 = ""', 'hrSWRunParameters.338 = ""', 'hrSWRunParameters.339 = ""', 'hrSWRunParameters.364 = ""', 'hrSWRunParameters.365 = ""', 'hrSWRunParameters.366 = ""', 'hrSWRunParameters.367 = ""', 'hrSWRunParameters.368 = ""', 'hrSWRunParameters.377 = ""', 'hrSWRunParameters.407 = ""', 'hrSWRunParameters.455 = "-d"', 'hrSWRunParameters.652 = ""', 'hrSWRunParameters.803 = "-d"', 'hrSWRunParameters.827 = ""', 'hrSWRunParameters.828 = ""', 'hrSWRunParameters.829 = ""', 'hrSWRunParameters.830 = ""', 'hrSWRunParameters.831 = ""', 'hrSWRunParameters.832 = ""', 'hrSWRunParameters.833 = ""', 'hrSWRunParameters.834 = ""', 'hrSWRunParameters.835 = ""', 'hrSWRunParameters.836 = ""', 'hrSWRunParameters.1086 = "-H tuvica01 -q -cf /etc/dhcp/dhclient-eth0.conf -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0"', 'hrSWRunParameters.1134 = ""', 'hrSWRunParameters.1141 = ""', 'hrSWRunParameters.1154 = "-i /var/run/syslogd.pid -c 5"', 'hrSWRunParameters.1183 = ""', 'hrSWRunParameters.1197 = ""', 'hrSWRunParameters.1215 = ""', 'hrSWRunParameters.1243 = ""', 'hrSWRunParameters.1244 = ""', 'hrSWRunParameters.1245 = ""', 'hrSWRunParameters.1246 = ""', 'hrSWRunParameters.1250 = ""', 'hrSWRunParameters.2330 = "-DRunAsApache"', 'hrSWRunParameters.2331 = "-DRunAsApache"', 'hrSWRunParameters.2332 = "-DRunAsApache"', 'hrSWRunParameters.2333 = "-DRunAsApache"', 'hrSWRunParameters.2334 = "-DRunAsApache"', 'hrSWRunParameters.2336 = "-DRunAsApache"', 'hrSWRunParameters.2337 = "-DRunAsApache"', 'hrSWRunParameters.2340 = "-DRunAsApache"', 'hrSWRunParameters.2342 = "-DRunAsApache"', 'hrSWRunParameters.2343 = "-DRunAsApache"', 'hrSWRunParameters.2344 = "-DRunAsApache"', 'hrSWRunParameters.2345 = "-DRunAsApache"', 'hrSWRunParameters.2346 = "-DRunAsApache"', 'hrSWRunParameters.2347 = "-DRunAsApache"', 'hrSWRunParameters.2348 = "-DRunAsApache"', 'hrSWRunParameters.2349 = "-DRunAsApache"', 'hrSWRunParameters.2350 = "-DRunAsApache"', 'hrSWRunParameters.2351 = "-DRunAsApache"', 'hrSWRunParameters.2352 = "-DRunAsApache"', 'hrSWRunParameters.2353 = "-DRunAsApache"', 'hrSWRunParameters.2354 = "-DRunAsApache"', 'hrSWRunParameters.2355 = "-DRunAsApache"', 'hrSWRunParameters.2356 = "-DRunAsApache"', 'hrSWRunParameters.2357 = "-DRunAsApache"', 'hrSWRunParameters.2358 = "-DRunAsApache"', 'hrSWRunParameters.2359 = "-DRunAsApache"', 'hrSWRunParameters.2360 = "-DRunAsApache"', 'hrSWRunParameters.2361 = "-DRunAsApache"', 'hrSWRunParameters.2362 = "-DRunAsApache"', 'hrSWRunParameters.2363 = "-DRunAsApache"', 'hrSWRunParameters.2364 = "-DRunAsApache"', 'hrSWRunParameters.2365 = "-DRunAsApache"', 'hrSWRunParameters.2366 = "-DRunAsApache"', 'hrSWRunParameters.2367 = "-DRunAsApache"', 'hrSWRunParameters.2368 = "-DRunAsApache"', 'hrSWRunParameters.2369 = "-DRunAsApache"', 'hrSWRunParameters.2370 = "-DRunAsApache"', 'hrSWRunParameters.2371 = "-DRunAsApache"', 'hrSWRunParameters.2372 = "-DRunAsApache"', 'hrSWRunParameters.2375 = "-DRunAsApache"', 'hrSWRunParameters.2376 = "-DRunAsApache"', 'hrSWRunParameters.2377 = "-DRunAsApache"', 'hrSWRunParameters.2378 = "-DRunAsApache"', 'hrSWRunParameters.2379 = "-DRunAsApache"', 'hrSWRunParameters.2380 = "-DRunAsApache"', 'hrSWRunParameters.2386 = "-DRunAsApache"', 'hrSWRunParameters.2387 = "-DRunAsApache"', 'hrSWRunParameters.2388 = "-DRunAsApache"', 'hrSWRunParameters.2389 = "-DRunAsApache"', 'hrSWRunParameters.2390 = "-DRunAsApache"', 'hrSWRunParameters.2391 = "-DRunAsApache"', 'hrSWRunParameters.2392 = "-DRunAsApache"', 'hrSWRunParameters.2393 = "-DRunAsApache"', 'hrSWRunParameters.2394 = "-DRunAsApache"', 'hrSWRunParameters.2395 = "-DRunAsApache"', 'hrSWRunParameters.2396 = "-DRunAsApache"', 'hrSWRunParameters.2397 = "-DRunAsApache"', 'hrSWRunParameters.2398 = "-DRunAsApache"', 'hrSWRunParameters.2399 = "-DRunAsApache"', 'hrSWRunParameters.2400 = "-DRunAsApache"', 'hrSWRunParameters.2401 = "-DRunAsApache"', 'hrSWRunParameters.2407 = "/opt/metricd/Metric.py /etc/metricd/metricd.conf"', 'hrSWRunParameters.3838 = "--system"', 'hrSWRunParameters.3877 = ""', 'hrSWRunParameters.3886 = ""', 'hrSWRunParameters.3887 = ""', 'hrSWRunParameters.3916 = ""', 'hrSWRunParameters.3937 = ""', 'hrSWRunParameters.3951 = "--pid-file /var/run/autofs.pid"', 'hrSWRunParameters.4167 = ""', 'hrSWRunParameters.4235 = "-u ntp:ntp -p /var/run/ntpd.pid -g -x"', 'hrSWRunParameters.4243 = "-c /etc/nagios/nrpe.cfg -d"', 'hrSWRunParameters.4335 = "/etc/rc3.d/S80yaml_server start"', 'hrSWRunParameters.4342 = ""', 'hrSWRunParameters.4353 = ""', 'hrSWRunParameters.4404 = "/dev/tty1"', 'hrSWRunParameters.4406 = "/dev/tty2"', 'hrSWRunParameters.4408 = "/dev/tty3"', 'hrSWRunParameters.4410 = "/dev/tty4"', 'hrSWRunParameters.4412 = "/dev/tty5"', 'hrSWRunParameters.4414 = "/dev/tty6"', 'hrSWRunParameters.4415 = "-d"', 'hrSWRunParameters.7180 = ""', 'hrSWRunParameters.7182 = ""', 'hrSWRunParameters.7630 = ""', 'hrSWRunParameters.7636 = "-l -t fifo -u"', 'hrSWRunParameters.7637 = "-l -t fifo -u"', 'hrSWRunParameters.7639 = "-t unix -u"', 'hrSWRunParameters.7640 = "-t unix -u"', 'hrSWRunParameters.7641 = "-z -n defer -t unix -u"', 'hrSWRunParameters.7649 = "-t unix -u"', 'hrSWRunParameters.7652 = "-z -n defer -t unix -u"', 'hrSWRunParameters.7654 = "-n retry -t unix -u"', 'hrSWRunParameters.7661 = "-n retry -t unix -u"', 'hrSWRunParameters.7670 = "-n retry -t unix -u"', 'hrSWRunParameters.7700 = ""', 'hrSWRunParameters.16321 = "-LS0-6d -Lf /dev/null -p /var/run/snmpd.pid"', 'hrSWRunParameters.20458 = "/usr/bin/diamond -p /var/run/diamond.pid"', 'hrSWRunParameters.20509 = "-DRunAsApache"', 'hrSWRunParameters.20617 = "-c /etc/icinga/ido2db.cfg"', 'hrSWRunParameters.20619 = "-d /etc/icinga/icinga.cfg"', 'hrSWRunParameters.20666 = ""', 'hrSWRunParameters.27133 = "-c /etc/icinga/ido2db.cfg"', '']

		out2 = {'4412': '/dev/tty5', '2407': '/opt/metricd/Metric.py /etc/metricd/metricd.conf', '2400': '-DRunAsApache', '2401': '-DRunAsApache', '20458': '/usr/bin/diamond -p /var/run/diamond.pid', '1154': '-i /var/run/syslogd.pid -c 5', '4335': '/etc/rc3.d/S80yaml_server start', '3838': '--system', '4235': '-u ntp:ntp -p /var/run/ntpd.pid -g -x', '4408': '/dev/tty3', '4404': '/dev/tty1', '4406': '/dev/tty2', '2396': '-DRunAsApache', '2397': '-DRunAsApache', '2394': '-DRunAsApache', '2395': '-DRunAsApache', '2392': '-DRunAsApache', '2393': '-DRunAsApache', '2390': '-DRunAsApache', '2391': '-DRunAsApache', '2398': '-DRunAsApache', '2399': '-DRunAsApache', '1086': '-H tuvica01 -q -cf /etc/dhcp/dhclient-eth0.conf -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0', '20617': '-c /etc/icinga/ido2db.cfg', '20619': '-d /etc/icinga/icinga.cfg', '20509': '-DRunAsApache', '7639': '-t unix -u', '4415': '-d', '4414': '/dev/tty6', '7636': '-l -t fifo -u', '7637': '-l -t fifo -u', '4410': '/dev/tty4', '2380': '-DRunAsApache', '2387': '-DRunAsApache', '2386': '-DRunAsApache', '2389': '-DRunAsApache', '2388': '-DRunAsApache', '16321': '-LS0-6d -Lf /dev/null -p /var/run/snmpd.pid', '3951': '--pid-file /var/run/autofs.pid', '27133': '-c /etc/icinga/ido2db.cfg', '2378': '-DRunAsApache', '2379': '-DRunAsApache', '2375': '-DRunAsApache', '2376': '-DRunAsApache', '2377': '-DRunAsApache', '2370': '-DRunAsApache', '2371': '-DRunAsApache', '2372': '-DRunAsApache', '455': '-d', '7652': '-z -n defer -t unix -u', '7654': '-n retry -t unix -u', '2369': '-DRunAsApache', '2368': '-DRunAsApache', '2367': '-DRunAsApache', '2366': '-DRunAsApache', '2365': '-DRunAsApache', '2364': '-DRunAsApache', '2363': '-DRunAsApache', '2362': '-DRunAsApache', '2361': '-DRunAsApache', '2360': '-DRunAsApache', '7641': '-z -n defer -t unix -u', '7640': '-t unix -u', '7649': '-t unix -u', '2358': '-DRunAsApache', '2359': '-DRunAsApache', '2352': '-DRunAsApache', '2353': '-DRunAsApache', '2350': '-DRunAsApache', '2351': '-DRunAsApache', '2356': '-DRunAsApache', '2357': '-DRunAsApache', '2354': '-DRunAsApache', '2355': '-DRunAsApache', '4243': '-c /etc/nagios/nrpe.cfg -d', '7670': '-n retry -t unix -u', '2345': '-DRunAsApache', '2344': '-DRunAsApache', '2347': '-DRunAsApache', '2346': '-DRunAsApache', '2340': '-DRunAsApache', '2343': '-DRunAsApache', '2342': '-DRunAsApache', '2349': '-DRunAsApache', '2348': '-DRunAsApache', '7661': '-n retry -t unix -u', '2330': '-DRunAsApache', '2331': '-DRunAsApache', '2332': '-DRunAsApache', '2333': '-DRunAsApache', '2334': '-DRunAsApache', '2336': '-DRunAsApache', '2337': '-DRunAsApache', '803': '-d'}

		in3 = ['hrSWRunParameters.1 = "carbon-cache.py bin/carbon-cache.py --instance=a start"']
		
		out3 = {'1': 'carbon-cache.py bin/carbon-cache.py --instance=a start'}

		self.assertEqual(check_snmp_procs.convert_list_to_kv_dict(in1),out1)
		self.assertEqual(check_snmp_procs.convert_list_to_kv_dict(in2),out2)
		# test for right handling of "=" occurence in parameters string not to be separated here
		self.assertEqual(check_snmp_procs.convert_list_to_kv_dict(in3),out3)


